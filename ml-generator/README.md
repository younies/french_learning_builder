# TCF Canada Expression Orale Generator

An AI-powered generator that creates personalized practice materials for TCF Canada Expression Orale using OpenAI's GPT models and expert-crafted prompts.

## 📋 Overview

This tool automatically generates high-quality practice content for TCF Canada Expression Orale by:
- Reading organized topics from the parser output
- Using specialized prompts for Task 2 (conversations) and Task 3 (monologues)
- Generating realistic practice scenarios with OpenAI
- Creating structured markdown files with vocabulary tables and strategic tips

## 🎯 Features

### ✅ **Intelligent Content Generation**
- **Task 2**: Interactive 3-minute conversations with role-playing scenarios
- **Task 3**: Structured 4.5-minute argumentative monologues
- **Expert prompts** designed by TCF Canada specialists
- **Canadian French integration** with appropriate cultural context

### ✅ **Advanced Language Learning**
- **B2+ to C1 level** complexity
- **Highlighted vocabulary** and expressions in bold
- **Comprehensive vocabulary tables** with translations and usage context
- **Strategic exam tips** integrated into each practice file

### ✅ **Flexible Processing**
- **Customizable limits** - Process specific numbers of topics
- **Task-specific generation** - Generate only Task 2 or Task 3 content
- **Progress tracking** - Real-time statistics and error handling
- **Rate limit management** - Built-in retry logic and delays

### ✅ **Professional Output**
- **Organized directory structure** with separate Task 2 and Task 3 folders
- **Metadata-rich files** with source tracking and generation timestamps
- **Clean markdown formatting** ready for study apps or printing
- **Unique filenames** generated from topic content

## 📁 File Structure

```
ml-generator/
├── orale_generator.py           # Main generator class
├── example_usage.py             # Usage examples and demos
├── eo_task2_prompt.txt         # Expert prompt for Task 2 conversations
├── eo_task3_prompt.txt         # Expert prompt for Task 3 monologues
└── README.md                   # This documentation
```

## 🔧 Installation & Setup

### Prerequisites
```bash
# Install dependencies
pip install -r requirements.txt

# Set OpenAI API key (required)
export OPENAI_API_KEY='your-openai-api-key-here'
```

### Dependencies
- **openai**: For GPT model API calls
- **Standard library**: json, os, time, re, pathlib, typing

### Required Files
- `organized_topics.json` (generated by the parser)
- `eo_task2_prompt.txt` and `eo_task3_prompt.txt` (expert prompts)

## 🚀 Usage

### Basic Usage (Interactive)
```bash
# Run with interactive prompts
python ml-generator/orale_generator.py

# You'll be asked:
# - How many Task 2 topics to process
# - How many Task 3 topics to process
# - Confirmation to proceed
```

### Programmatic Usage

#### Simple Generation
```python
from ml_generator.orale_generator import TCFOraleGenerator

# Initialize generator
generator = TCFOraleGenerator()

# Generate limited content for testing
generator.generate_all_content(task2_limit=5, task3_limit=3)
```

#### Advanced Usage
```python
# Custom output directory
generator = TCFOraleGenerator(
    output_base_dir="/path/to/custom/directory"
)

# Load topics manually
task2_topics, task3_topics = generator.load_organized_topics()

# Generate specific task content
generator.generate_task2_content(task2_topics, limit=10)
generator.generate_task3_content(task3_topics, limit=8)

# Preview topics before generation
generator.preview_topics(num_samples=5)
```

#### With Custom API Key
```python
# Pass API key directly
generator = TCFOraleGenerator(api_key="your-api-key-here")
generator.generate_all_content(task2_limit=2, task3_limit=2)
```

## 📊 Output Structure

### Directory Organization
```
../french_learning/tcf_canada/eo/
├── task2/
│   ├── task2_001_Je_suis_un_de_vos_collegues.md
│   ├── task2_002_Je_suis_votre_ami_et_je_vous_invite.md
│   └── ...
└── task3/
    ├── task3_001_Pensez_vous_que_la_gentillesse.md
    ├── task3_002_Pensez_vous_qu_il_est_possible.md
    └── ...
```

### File Content Structure
Each generated file contains:

```markdown
---
# TCF Canada Expression Orale - Generated Practice
source_file: aout-2025-expression-orale.json
source_url: https://reussir-tcfcanada.com/aout-2025-expression-orale/
task: tache_2
part: partie_1
generated_at: 2025-01-27 15:30:45
---

# Original Topic
[Original topic content from TCF website]

---

[AI-generated practice content with highlighted vocabulary and tables]
```

## 🎓 Generated Content Quality

### Task 2 (Conversations)
- **8-12 realistic exchanges** between candidate and role-player
- **Natural conversation flow** with reactions and follow-ups
- **Context-appropriate register** (formal/informal)
- **Question formulation practice** with varied structures
- **Active listening elements** and clarification requests

### Task 3 (Monologues)
- **Structured 4.5-minute monologues** with clear argumentation
- **Introduction, development, conclusion** with precise timing
- **Concrete examples** and supporting evidence
- **Advanced connectors** and sophisticated vocabulary
- **Nuanced positions** with counter-argument consideration

### Vocabulary Enhancement
- **Bold highlighting** of useful expressions throughout
- **Comprehensive tables** with French/English translations
- **Usage context** explanations for each expression
- **Strategic tips** for exam success

## ⚙️ Configuration Options

### TCFOraleGenerator Parameters
```python
TCFOraleGenerator(
    api_key=None,                    # OpenAI API key (or use env var)
    output_base_dir="path/to/output" # Base directory for generated files
)
```

### Generation Limits
- `task2_limit`: Number of Task 2 topics to process (None = all)
- `task3_limit`: Number of Task 3 topics to process (None = all)

### OpenAI Settings (in code)
- **Model**: GPT-4 (configurable to GPT-3.5-turbo for cost savings)
- **Max tokens**: 2000 per generation
- **Temperature**: 0.7 for creative but consistent output

## 📈 Performance & Statistics

### Typical Processing
- **Processing speed**: ~2-3 seconds per topic (including API delay)
- **Success rate**: 95%+ with retry logic
- **Content quality**: B2+ to C1 level French
- **File size**: 3-8 KB per generated markdown file

### Statistics Tracking
The generator provides detailed statistics:
```
📊 Statistics:
   - Task 2 files generated: 15
   - Task 3 files generated: 12
   - Total API calls made: 27
   - Errors encountered: 0
   - Topics skipped: 0
   - Total files created: 27
```

## 🛠️ Advanced Features

### Error Handling
- **Rate limit management** with exponential backoff
- **API error recovery** with retry logic (3 attempts)
- **Graceful failure handling** - continues with other topics
- **Progress tracking** - shows current topic being processed

### File Management
- **Unique filename generation** from topic content
- **Safe character handling** for cross-platform compatibility
- **Metadata preservation** in file headers
- **Directory auto-creation** if paths don't exist

### Content Optimization
- **Canadian French integration** - Quebec expressions when appropriate
- **Cultural context awareness** - References to Canadian society
- **Exam-specific formatting** - Follows TCF Canada requirements
- **Progressive difficulty** - Maintains chronological topic order

## 🔍 Troubleshooting

### Common Issues

#### API Key Problems
```bash
# Error: OpenAI API key not found
export OPENAI_API_KEY='your-actual-api-key'

# Or pass directly in code
generator = TCFOraleGenerator(api_key="your-key")
```

#### Missing Files
```bash
# Error: organized_topics.json not found
# Run the parser first:
python parser/parser.py
```

#### Rate Limits
```bash
# The generator automatically handles rate limits with delays
# For heavy usage, consider:
# 1. Using GPT-3.5-turbo instead of GPT-4
# 2. Processing smaller batches
# 3. Adding longer delays between calls
```

#### Permission Errors
```bash
# Ensure the output path exists and is writable
mkdir -p ../french_learning/tcf_canada/eo
```

### Debug Mode
```python
# Enable verbose output for debugging
generator = TCFOraleGenerator()
generator.preview_topics(10)  # Preview before generation
```

## 💡 Best Practices

### For Efficient Generation
1. **Start small** - Test with limits of 2-3 topics first
2. **Monitor API usage** - Track costs and rate limits
3. **Use appropriate model** - GPT-4 for quality, GPT-3.5 for speed/cost
4. **Batch processing** - Process in chunks to avoid long sessions

### For Quality Content
1. **Review prompts** - Customize `eo_task2_prompt.txt` and `eo_task3_prompt.txt`
2. **Check outputs** - Verify first few generated files for quality
3. **Adjust limits** - Balance quantity vs. processing time
4. **Update topics** - Regenerate when new scraped content is available

### For Study Effectiveness
1. **Organize by difficulty** - Generated files maintain chronological order
2. **Use metadata** - Track which topics you've practiced
3. **Focus on vocabulary** - Study the highlighted expressions tables
4. **Practice timing** - Use the structured formats for realistic practice

## 🚀 Integration with Project

### Workflow Integration
```bash
# 1. Scrape topics
python app/main.py

# 2. Parse and organize
python parser/parser.py

# 3. Generate practice content
python ml-generator/orale_generator.py
```

### With Other Tools
- **Parser integration** - Reads `organized_topics.json` automatically
- **Study app integration** - Generates markdown compatible with most apps
- **Print-friendly** - Clean formatting for physical study materials

## 📄 License & Credits

This generator is part of the French Learning Builder project and uses:
- **OpenAI GPT models** for content generation
- **Expert-crafted prompts** designed for TCF Canada
- **Real TCF topics** scraped from official practice sites

## 🤝 Contributing

### Prompt Improvement
- Edit `eo_task2_prompt.txt` for conversation scenarios
- Edit `eo_task3_prompt.txt` for monologue structures
- Test changes with small topic limits first

### Feature Additions
- Add new output formats (PDF, audio scripts, etc.)
- Implement additional language models
- Add more sophisticated error handling
- Create batch processing utilities

### Quality Enhancement
- Improve Canadian French expressions database
- Add more sophisticated vocabulary categorization
- Implement content difficulty scoring
- Add automatic quality assessment

---

**Ready to generate world-class TCF Canada practice materials?** 🇨🇦✨

Set your OpenAI API key and start creating personalized study content that adapts to real exam topics!
